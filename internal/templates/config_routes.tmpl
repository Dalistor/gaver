package routes

import (
	"github.com/gin-gonic/gin"
)

// ModuleInterface define a interface que todos os módulos devem implementar
type ModuleInterface interface {
	RegisterRoutes(router *gin.RouterGroup)
	Init() error
}

// Registry gerencia o registro de módulos
type Registry struct {
	modules map[string]ModuleInterface
}

// NewRegistry cria um novo registro de módulos
func NewRegistry() *Registry {
	return &Registry{
		modules: make(map[string]ModuleInterface),
	}
}

// Register registra um módulo
func (r *Registry) Register(name string, module ModuleInterface) {
	r.modules[name] = module
}

// RegisterAll registra as rotas de todos os módulos em um router group
func (r *Registry) RegisterAll(router *gin.RouterGroup) {
	for _, module := range r.modules {
		module.RegisterRoutes(router)
	}
}

// InitAll inicializa todos os módulos
func (r *Registry) InitAll() error {
	for _, module := range r.modules {
		if err := module.Init(); err != nil {
			return err
		}
	}
	return nil
}

// GetModules retorna todos os módulos registrados
func (r *Registry) GetModules() map[string]ModuleInterface {
	return r.modules
}

